<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>everyWrite | NorthUnicorn</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.eab45adb.css" as="style"><link rel="preload" href="/assets/js/app.2d5a21ba.js" as="script"><link rel="preload" href="/assets/js/62.3f032d2a.js" as="script"><link rel="prefetch" href="/assets/js/10.8a362e98.js"><link rel="prefetch" href="/assets/js/11.d74a0997.js"><link rel="prefetch" href="/assets/js/12.e2a162e2.js"><link rel="prefetch" href="/assets/js/13.84c6fa39.js"><link rel="prefetch" href="/assets/js/14.c4eac9aa.js"><link rel="prefetch" href="/assets/js/15.6e106e89.js"><link rel="prefetch" href="/assets/js/16.9e29e9f1.js"><link rel="prefetch" href="/assets/js/17.9b3a8933.js"><link rel="prefetch" href="/assets/js/18.f0190824.js"><link rel="prefetch" href="/assets/js/19.9e8ce3c8.js"><link rel="prefetch" href="/assets/js/2.39847600.js"><link rel="prefetch" href="/assets/js/20.f1e6b579.js"><link rel="prefetch" href="/assets/js/21.f06a428f.js"><link rel="prefetch" href="/assets/js/22.e8fff36c.js"><link rel="prefetch" href="/assets/js/23.9be9c45e.js"><link rel="prefetch" href="/assets/js/24.b1a2e86a.js"><link rel="prefetch" href="/assets/js/25.2721ff74.js"><link rel="prefetch" href="/assets/js/26.2cca1f22.js"><link rel="prefetch" href="/assets/js/27.60ac312a.js"><link rel="prefetch" href="/assets/js/28.a51bcc0b.js"><link rel="prefetch" href="/assets/js/29.d4d7922b.js"><link rel="prefetch" href="/assets/js/3.e8366ca8.js"><link rel="prefetch" href="/assets/js/30.284529e8.js"><link rel="prefetch" href="/assets/js/31.329482e5.js"><link rel="prefetch" href="/assets/js/32.1dd41dba.js"><link rel="prefetch" href="/assets/js/33.cdaf88aa.js"><link rel="prefetch" href="/assets/js/34.d2260297.js"><link rel="prefetch" href="/assets/js/35.0f100cdc.js"><link rel="prefetch" href="/assets/js/36.2d7b8183.js"><link rel="prefetch" href="/assets/js/37.58e42fab.js"><link rel="prefetch" href="/assets/js/38.b702c8f5.js"><link rel="prefetch" href="/assets/js/39.82cf90ef.js"><link rel="prefetch" href="/assets/js/4.f13a62f3.js"><link rel="prefetch" href="/assets/js/40.5e523f7a.js"><link rel="prefetch" href="/assets/js/41.bdd3935e.js"><link rel="prefetch" href="/assets/js/42.38f97d1a.js"><link rel="prefetch" href="/assets/js/43.fde099dd.js"><link rel="prefetch" href="/assets/js/44.1c37dd97.js"><link rel="prefetch" href="/assets/js/45.98b02b2e.js"><link rel="prefetch" href="/assets/js/46.42f3fcd7.js"><link rel="prefetch" href="/assets/js/47.e82a83b5.js"><link rel="prefetch" href="/assets/js/48.198aa16b.js"><link rel="prefetch" href="/assets/js/49.584f6640.js"><link rel="prefetch" href="/assets/js/5.1ee23f75.js"><link rel="prefetch" href="/assets/js/50.8b31f4da.js"><link rel="prefetch" href="/assets/js/51.78f5d0ad.js"><link rel="prefetch" href="/assets/js/52.31174a6a.js"><link rel="prefetch" href="/assets/js/53.077bd356.js"><link rel="prefetch" href="/assets/js/54.3de7f928.js"><link rel="prefetch" href="/assets/js/55.3ad4df39.js"><link rel="prefetch" href="/assets/js/56.785eabef.js"><link rel="prefetch" href="/assets/js/57.8b4691e9.js"><link rel="prefetch" href="/assets/js/58.f7997b54.js"><link rel="prefetch" href="/assets/js/59.d7a4d8a8.js"><link rel="prefetch" href="/assets/js/6.705f6278.js"><link rel="prefetch" href="/assets/js/60.ddb9f94c.js"><link rel="prefetch" href="/assets/js/61.26981a47.js"><link rel="prefetch" href="/assets/js/63.39527714.js"><link rel="prefetch" href="/assets/js/64.8868dd89.js"><link rel="prefetch" href="/assets/js/65.6b974d81.js"><link rel="prefetch" href="/assets/js/66.855c5823.js"><link rel="prefetch" href="/assets/js/67.31e1762e.js"><link rel="prefetch" href="/assets/js/68.8c46b6ac.js"><link rel="prefetch" href="/assets/js/69.86ace7af.js"><link rel="prefetch" href="/assets/js/7.1fd1c381.js"><link rel="prefetch" href="/assets/js/70.351ae70a.js"><link rel="prefetch" href="/assets/js/71.1d26e844.js"><link rel="prefetch" href="/assets/js/72.1df64755.js"><link rel="prefetch" href="/assets/js/73.090c6271.js"><link rel="prefetch" href="/assets/js/74.5788c180.js"><link rel="prefetch" href="/assets/js/75.74f8c6f5.js"><link rel="prefetch" href="/assets/js/76.7e7562cd.js"><link rel="prefetch" href="/assets/js/77.777397ae.js"><link rel="prefetch" href="/assets/js/78.d7cc5ce5.js"><link rel="prefetch" href="/assets/js/79.d294b892.js"><link rel="prefetch" href="/assets/js/8.60fbcf9b.js"><link rel="prefetch" href="/assets/js/80.99fd18d4.js"><link rel="prefetch" href="/assets/js/81.2c0e2273.js"><link rel="prefetch" href="/assets/js/9.c9c66d36.js">
    <link rel="stylesheet" href="/assets/css/0.styles.eab45adb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NorthUnicorn</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front/" class="nav-link">前端</a></div><div class="nav-item"><a href="/houduan/" class="nav-link">后端</a></div><div class="nav-item"><a href="/operation/" class="nav-link">operation</a></div><div class="nav-item"><a href="/interview/" class="nav-link router-link-active">interview</a></div><div class="nav-item"><a href="/article/" class="nav-link">article</a></div><div class="nav-item"><a href="https://github.com/xiaoqi7777" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about/" class="nav-link">about</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front/" class="nav-link">前端</a></div><div class="nav-item"><a href="/houduan/" class="nav-link">后端</a></div><div class="nav-item"><a href="/operation/" class="nav-link">operation</a></div><div class="nav-item"><a href="/interview/" class="nav-link router-link-active">interview</a></div><div class="nav-item"><a href="/article/" class="nav-link">article</a></div><div class="nav-item"><a href="https://github.com/xiaoqi7777" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about/" class="nav-link">about</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>interview</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/interview/design.html" class="sidebar-link">设计模式</a></li><li><a href="/interview/algorithm.html" class="sidebar-link">1</a></li><li><a href="/interview/subject.html" class="sidebar-link">js算法&amp;&amp;经典考题</a></li><li><a href="/interview/leetcode.html" class="sidebar-link">leetcode</a></li><li><a href="/interview/everyWrite.html" class="active sidebar-link">everyWrite</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#冒泡" class="sidebar-link">冒泡</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#快速" class="sidebar-link">快速</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#选择排序" class="sidebar-link">选择排序</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#原型链-规则" class="sidebar-link">原型链 规则</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#new-原理" class="sidebar-link">new 原理</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#class-extends" class="sidebar-link">class extends</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#深拷贝" class="sidebar-link">深拷贝</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#call" class="sidebar-link">call</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#apply" class="sidebar-link">apply</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#mybind" class="sidebar-link">mybind</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#数组数据打乱" class="sidebar-link">数组数据打乱</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#promise-catch-reject-finally-all-race" class="sidebar-link">promise  catch reject finally all race</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#koa-中间件" class="sidebar-link">koa 中间件</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#map" class="sidebar-link">map</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#函数柯里化" class="sidebar-link">函数柯里化</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#数组扁平化flat方法的多种实现" class="sidebar-link">数组扁平化flat方法的多种实现</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#如何让-a-1-a-2-a-3-的值为true" class="sidebar-link">如何让 (a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3) 的值为true</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#编写parse函数，实现访问对象里属性的值" class="sidebar-link">编写parse函数，实现访问对象里属性的值</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#sleep方法封装" class="sidebar-link">sleep方法封装</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#数组-交集-并集-差集" class="sidebar-link">数组 交集 并集 差集</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#节流" class="sidebar-link">节流</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#防抖" class="sidebar-link">防抖</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#路由-路径参数解析" class="sidebar-link">路由 路径参数解析</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#模板字符串" class="sidebar-link">模板字符串</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#观察者模式" class="sidebar-link">观察者模式</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#发布订阅" class="sidebar-link">发布订阅</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#webpack-执行过程" class="sidebar-link">webpack 执行过程</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#主要的生命周期-插件" class="sidebar-link">主要的生命周期 插件</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#jsonp" class="sidebar-link">jsonp</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#ajax" class="sidebar-link">ajax</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#懒加载" class="sidebar-link">懒加载</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#hot-更新" class="sidebar-link">hot 更新</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#loader" class="sidebar-link">loader</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#express" class="sidebar-link">express</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#react-0-3版本的" class="sidebar-link">React(0.3版本的)</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#vue" class="sidebar-link">vue</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#vue-router" class="sidebar-link">vue-router</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#fiber" class="sidebar-link">fiber</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#微前端" class="sidebar-link">微前端</a></li><li class="sidebar-sub-header"><a href="/interview/everyWrite.html#性能监控" class="sidebar-link">性能监控</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Base</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/interview/cssBase.html" class="sidebar-link">css</a></li><li><a href="/interview/jsBase.html" class="sidebar-link">js</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>interview</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/interview/interviewBase.html" class="sidebar-link">html/css面试题</a></li><li><a href="/interview/interviewJs.html" class="sidebar-link">js面试题</a></li><li><a href="/interview/interviewVue.html" class="sidebar-link">vue 面试题</a></li><li><a href="/interview/interviewWebpack.html" class="sidebar-link">webpack面试题</a></li><li><a href="/interview/status.html" class="sidebar-link">状态码</a></li><li><a href="/interview/suanfa.html" class="sidebar-link">算法题目</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="everywrite"><a href="#everywrite" aria-hidden="true" class="header-anchor">#</a> everyWrite</h1> <p></p><div class="table-of-contents"><ul><li><a href="#冒泡">冒泡</a></li><li><a href="#快速">快速</a></li><li><a href="#选择排序">选择排序</a></li><li><a href="#原型链-规则">原型链 规则</a></li><li><a href="#new-原理">new 原理</a></li><li><a href="#class-extends">class extends</a></li><li><a href="#深拷贝">深拷贝</a></li><li><a href="#call">call</a></li><li><a href="#apply">apply</a></li><li><a href="#mybind">mybind</a></li><li><a href="#数组数据打乱">数组数据打乱</a></li><li><a href="#promise-catch-reject-finally-all-race">promise  catch reject finally all race</a></li><li><a href="#koa-中间件">koa 中间件</a></li><li><a href="#map">map</a></li><li><a href="#函数柯里化">函数柯里化</a></li><li><a href="#数组扁平化flat方法的多种实现">数组扁平化flat方法的多种实现</a></li><li><a href="#如何让-a-1-a-2-a-3-的值为true">如何让 (a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3) 的值为true</a></li><li><a href="#编写parse函数，实现访问对象里属性的值">编写parse函数，实现访问对象里属性的值</a></li><li><a href="#sleep方法封装">sleep方法封装</a></li><li><a href="#数组-交集-并集-差集">数组 交集 并集 差集</a></li><li><a href="#节流">节流</a></li><li><a href="#防抖">防抖</a></li><li><a href="#路由-路径参数解析">路由 路径参数解析</a></li><li><a href="#模板字符串">模板字符串</a></li><li><a href="#观察者模式">观察者模式</a></li><li><a href="#发布订阅">发布订阅</a></li><li><a href="#webpack-执行过程">webpack 执行过程</a></li><li><a href="#主要的生命周期-插件">主要的生命周期 插件</a></li><li><a href="#jsonp">jsonp</a></li><li><a href="#ajax">ajax</a></li><li><a href="#懒加载">懒加载</a></li><li><a href="#hot-更新">hot 更新</a></li><li><a href="#loader">loader</a></li><li><a href="#express">express</a><ul><li><a href="#子路由系統">子路由系統</a></li><li><a href="#路径参数处理">路径参数处理</a></li><li><a href="#path-to-regexp">path-to-RegExp</a></li><li><a href="#模板引擎">模板引擎</a></li><li><a href="#中间件">中间件</a></li><li><a href="#ejs">ejs</a></li></ul></li><li><a href="#react-0-3版本的">React(0.3版本的)</a><ul><li><a href="#react-渲染流程">React 渲染流程</a></li><li><a href="#diff-比较">diff 比较</a></li><li><a href="#redux">redux</a></li></ul></li><li><a href="#vue">vue</a><ul><li><a href="#domdiff">DOMDiff</a></li><li><a href="#完整的导航解析流程">完整的导航解析流程</a></li><li><a href="#vuex">vuex</a></li><li><a href="#vuex原理">vuex原理</a></li></ul></li><li><a href="#vue-router">vue-router</a></li><li><a href="#fiber">fiber</a></li><li><a href="#微前端">微前端</a><ul><li><a href="#执行流程-核心">执行流程(核心)</a></li></ul></li><li><a href="#性能监控">性能监控</a></li></ul></div><p></p> <h2 id="冒泡"><a href="#冒泡" aria-hidden="true" class="header-anchor">#</a> 冒泡</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="快速"><a href="#快速" aria-hidden="true" class="header-anchor">#</a> 快速</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
    <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> arr
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> midindex <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> len<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> right <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> left <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> midindex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            left<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            right<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>midindex<span class="token punctuation">,</span> <span class="token function">fn</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="选择排序"><a href="#选择排序" aria-hidden="true" class="header-anchor">#</a> 选择排序</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        index <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">&gt;</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                index <span class="token operator">=</span> j
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="原型链-规则"><a href="#原型链-规则" aria-hidden="true" class="header-anchor">#</a> 原型链 规则</h2> <ul><li>1、所有引用对象都是可以拓展其属性</li> <li>2、引用对象都有一个 <strong>proto</strong> 属性 他是一个普通对象</li> <li>3、函数都有一个 prototype 属性他是一个普通对象</li> <li>4、引用对象的__proto__ 指向 构造函数的prototype</li> <li>5、当试图得到对象的某一个属性,会先在自身查找,找不到在去构造函数的prototype找,直到找到Object</li></ul> <h2 id="new-原理"><a href="#new-原理" aria-hidden="true" class="header-anchor">#</a> new 原理</h2> <ul><li>1、创建一个空对象,关联构造函数的原型</li> <li>2、执行构造函数,this指向当前对象</li> <li>3、判断执行的结果 若是对象即返回 否则返回新的对象</li></ul> <h2 id="class-extends"><a href="#class-extends" aria-hidden="true" class="header-anchor">#</a> class extends</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Father</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> staticFatherName <span class="token operator">=</span> <span class="token string">'FatherName'</span>
  <span class="token keyword">static</span> <span class="token function-variable function">staticGetFatherName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Father<span class="token punctuation">.</span>staticFatherName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 他是放在实例上的</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'1111111111'</span>
  <span class="token punctuation">}</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 他是放在原型上的</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Father</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> staticChildName <span class="token operator">=</span> <span class="token string">'ChildName'</span>
  <span class="token keyword">static</span> <span class="token function-variable function">staticGetChildName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Child<span class="token punctuation">.</span>staticChildName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> name<span class="token punctuation">,</span><span class="token keyword">public</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'name111111111'</span>
  <span class="token punctuation">}</span>
  <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'zhefeng'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Child<span class="token punctuation">.</span><span class="token function">staticGetChildName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Child<span class="token punctuation">.</span><span class="token function">staticGetFatherName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment">// es5</span>
<span class="token keyword">function</span> <span class="token function">_extends</span><span class="token punctuation">(</span><span class="token parameter">Child<span class="token punctuation">,</span>Father</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  Child<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> Father<span class="token punctuation">;</span><span class="token comment">//继承静态属性的方法</span>
  <span class="token keyword">function</span> <span class="token function">Temp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// constructor 指向子类的构造函数</span>
    <span class="token comment">// this.constructor = Child</span>
  <span class="token punctuation">}</span>
  <span class="token class-name">Temp</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Father</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
  <span class="token class-name">Temp</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child<span class="token punctuation">;</span>
  <span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Temp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> Father <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">Father</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token punctuation">}</span>
  <span class="token class-name">Father</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  Father<span class="token punctuation">.</span>staticFatherName <span class="token operator">=</span> <span class="token string">'FatherName'</span>
  Father<span class="token punctuation">.</span><span class="token function-variable function">staticGetFatherName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Father<span class="token punctuation">.</span>staticFatherName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> Father
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_super</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">_extends</span><span class="token punctuation">(</span>Child<span class="token punctuation">,</span>_super<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">_super</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  Child<span class="token punctuation">.</span>staticChildName <span class="token operator">=</span> <span class="token string">'ChildName'</span><span class="token punctuation">;</span>
  Child<span class="token punctuation">.</span><span class="token function-variable function">staticGetChildName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Child<span class="token punctuation">.</span>staticChildName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> Child
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Father<span class="token punctuation">)</span>
<span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// child.getAge();</span>
Child<span class="token punctuation">.</span><span class="token function">staticGetChildName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Child<span class="token punctuation">.</span><span class="token function">staticGetFatherName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="深拷贝"><a href="#深拷贝" aria-hidden="true" class="header-anchor">#</a> 深拷贝</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> 
  name<span class="token punctuation">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span> 
  age<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> 
  datas<span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  hobbies<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'抽烟'</span><span class="token punctuation">,</span><span class="token string">'喝酒'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj1<span class="token punctuation">.</span>obj1 <span class="token operator">=</span> obj1
<span class="token comment">// map key源对象的内存地址 值是克隆后的对象的内存地址</span>
<span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> obj <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> obj
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">RegExp</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">let</span> newObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">obj<span class="token punctuation">.</span>constructor</span>
  <span class="token comment">// 递归 处理</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> 
  map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>newObj<span class="token punctuation">)</span>  
  
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    newObj<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>map<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newObj
<span class="token punctuation">}</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span>
rs<span class="token punctuation">.</span>datas<span class="token punctuation">.</span>s<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">11111111</span>
rs<span class="token punctuation">.</span>hobbies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'11'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span>
</code></pre></div><h2 id="call"><a href="#call" aria-hidden="true" class="header-anchor">#</a> call</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mycall</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">:</span> window
    context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>

    <span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'context.fn('</span> <span class="token operator">+</span> args <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span>
    <span class="token comment">// let rs = eval(`context.fn(${args})`)</span>
    <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
fn<span class="token punctuation">.</span><span class="token function">mycall</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="apply"><a href="#apply" aria-hidden="true" class="header-anchor">#</a> apply</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myapply</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">:</span> window
    context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>

    <span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'context.fn('</span> <span class="token operator">+</span> args <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span>
    <span class="token comment">// let rs = eval(`context.fn(${args})`)</span>
    <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
fn<span class="token punctuation">.</span><span class="token function">myapply</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="mybind"><a href="#mybind" aria-hidden="true" class="header-anchor">#</a> mybind</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mybind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">:</span> window
    <span class="token keyword">let</span> bindArgs <span class="token operator">=</span> args
    <span class="token keyword">let</span> that <span class="token operator">=</span> <span class="token keyword">this</span>

    <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    fn<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prototype

    <span class="token keyword">function</span> <span class="token function">fBound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> fArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">that</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">fBound</span> <span class="token operator">?</span> <span class="token keyword">this</span> <span class="token punctuation">:</span> context<span class="token punctuation">,</span> bindArgs<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>fArgs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fBound<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> fBound
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> fn<span class="token punctuation">.</span><span class="token function">mybind</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="数组数据打乱"><a href="#数组数据打乱" aria-hidden="true" class="header-anchor">#</a> 数组数据打乱</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> midindex <span class="token operator">=</span> i <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>len <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>midindex<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>midindex<span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="promise-catch-reject-finally-all-race"><a href="#promise-catch-reject-finally-all-race" aria-hidden="true" class="header-anchor">#</a> promise  catch reject finally all race</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">catch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

Promise<span class="token punctuation">.</span><span class="token function-variable function">reject</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">finally</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">throw</span> err <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> pro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'seccuss'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

pro<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data1'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'12312312'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1231'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">all</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            index<span class="token operator">++</span><span class="token punctuation">;</span>
            rs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            promises<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">fn</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">race</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            promises<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="koa-中间件"><a href="#koa-中间件" aria-hidden="true" class="header-anchor">#</a> koa 中间件</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
app<span class="token punctuation">.</span>middlewares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
app<span class="token punctuation">.</span><span class="token function-variable function">use</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span>middlewares<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> <span class="token function-variable function">dispatch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> app<span class="token punctuation">.</span>middlewares<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">let</span> route <span class="token operator">=</span> app<span class="token punctuation">.</span>middlewares<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    <span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token operator">++</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> app<span class="token punctuation">.</span>middlewares<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token operator">...</span>fn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> app<span class="token punctuation">.</span>middlewares<span class="token punctuation">.</span><span class="token function">reduceRight</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token operator">...</span>fn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">rs</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="map"><a href="#map" aria-hidden="true" class="header-anchor">#</a> map</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>  
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mymap</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> a
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">mymap</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>
</code></pre></div><h2 id="函数柯里化"><a href="#函数柯里化" aria-hidden="true" class="header-anchor">#</a> 函数柯里化</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1、收集数组</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>

<span class="token keyword">const</span> add <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> AllArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">function</span> <span class="token function">_add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    AllArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>AllArgs<span class="token punctuation">,</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>AllArgs<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> total<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> rs <span class="token operator">=</span> AllArgs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span>
      AllArgs<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">return</span> rs
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> _add
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> _add
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>


<span class="token comment">// 2、利用toString</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>

<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> _add <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  _add<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span>  args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> _add
<span class="token punctuation">}</span>


<span class="token comment">// 3、利用 递归</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//15</span>

<span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> args<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> fn<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>innerArgs</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token function">curry</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span><span class="token operator">...</span>args<span class="token punctuation">,</span><span class="token operator">...</span>innerArgs<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">_add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span>d<span class="token operator">+</span>e
<span class="token punctuation">}</span>

<span class="token keyword">let</span> add <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>_add<span class="token punctuation">)</span>
</code></pre></div><h2 id="数组扁平化flat方法的多种实现"><a href="#数组扁平化flat方法的多种实现" aria-hidden="true" class="header-anchor">#</a> 数组扁平化flat方法的多种实现</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">12</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 1、</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 2、toString() 能将多层数组扁平化 </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token function">Number</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 3、JSON.stringify 和 toString类似</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\[|\]/g</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token function">Number</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 4、concat可以展开一层</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arr<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
<span class="token comment">// 5、flat 里面递归处理</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myFlat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">_flat</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> item <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">_flat</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        rs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> 
  <span class="token function">_flat</span><span class="token punctuation">(</span>_this<span class="token punctuation">)</span>
  <span class="token keyword">return</span> rs
<span class="token punctuation">}</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">myFlat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>
</code></pre></div><h2 id="如何让-a-1-a-2-a-3-的值为true"><a href="#如何让-a-1-a-2-a-3-的值为true" aria-hidden="true" class="header-anchor">#</a> 如何让 (a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3) 的值为true</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1、Symbol.toPrimitive</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2、Proxy</span>
<span class="token keyword">let</span> a <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  i<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token keyword">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>i<span class="token operator">++</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 3、valueOf</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  i<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function-variable function">valueOf</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>i
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 4、toString</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  i<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function-variable function">toString</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>i
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 5、 Object.defineProperty</span>
<span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span>i
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 6、toString配合数组</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
a<span class="token punctuation">.</span>toString <span class="token operator">=</span> a<span class="token punctuation">.</span>shift

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="编写parse函数，实现访问对象里属性的值"><a href="#编写parse函数，实现访问对象里属性的值" aria-hidden="true" class="header-anchor">#</a> 编写parse函数，实现访问对象里属性的值</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> 
  a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
  b<span class="token punctuation">:</span> <span class="token punctuation">{</span> c<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  d<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  e<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> f<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// = 1;</span>
<span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'b.c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// = 2;</span>
<span class="token keyword">let</span> r3 <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'d[2]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// = 3;</span>
<span class="token keyword">let</span> r4 <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'e[0].f[0]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// = 4;</span>
<span class="token comment">// function parse(obj,str){</span>
<span class="token comment">//   let rs = new Function('obj','return obj.'+str)</span>
<span class="token comment">//   return rs(obj)</span>
<span class="token comment">// }</span>
<span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span>str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 正则将 e[0] =&gt; e.0 </span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\[(\d+)\]/g</span><span class="token punctuation">,</span><span class="token template-string"><span class="token string">`.$1`</span></span><span class="token punctuation">)</span>
  <span class="token comment">// str = str.replace(/\[(\d+)\]/g,($0,$1)=&gt;`.${$1}`)</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>
  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    obj <span class="token operator">=</span> obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>r3<span class="token punctuation">,</span>r4<span class="token punctuation">)</span>
</code></pre></div><h2 id="sleep方法封装"><a href="#sleep方法封装" aria-hidden="true" class="header-anchor">#</a> sleep方法封装</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 普通</span>
<span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">delay</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start <span class="token operator">&lt;=</span> delay<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 基于promise</span>
<span class="token keyword">function</span> <span class="token function">sleep_wait</span><span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>ms<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="数组-交集-并集-差集"><a href="#数组-交集-并集-差集" aria-hidden="true" class="header-anchor">#</a> 数组 交集 并集 差集</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>

并集
<span class="token keyword">let</span> set1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">,</span> <span class="token operator">...</span>arr2<span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>set1<span class="token punctuation">)</span>

差集
arr1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span>
arr2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>arr2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>

交集
arr1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span>
arr2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
<span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> arr2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>
</code></pre></div><h2 id="节流"><a href="#节流" aria-hidden="true" class="header-anchor">#</a> 节流</h2> <ul><li>一段时间内会触发一次</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>btn<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 节流 一段时间内只会触发一次</span>
      <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span><span class="token keyword">await</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> pre <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">let</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
          <span class="token keyword">if</span><span class="token punctuation">(</span>now<span class="token operator">-</span>pre<span class="token operator">&gt;</span><span class="token keyword">await</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            pre <span class="token operator">=</span> now
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>        
      <span class="token punctuation">}</span>
      <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span>
      dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token function">throttle</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="防抖"><a href="#防抖" aria-hidden="true" class="header-anchor">#</a> 防抖</h2> <ul><li>一直按只会触发一次</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>btn<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span><span class="token keyword">await</span><span class="token punctuation">,</span>immediate</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> timeout<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>immediate<span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>timeout<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span>
        timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">await</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span>
    dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token function">throttle</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="路由-路径参数解析"><a href="#路由-路径参数解析" aria-hidden="true" class="header-anchor">#</a> 路由 路径参数解析</h2> <ul><li>请求的路径 url=<code>/url1/123/sg</code></li> <li>自定义的路由 reg = <code>url1/:id/:name</code></li> <li>得到 =&gt; {id:123,name:sg}</li> <li>exec 匹配的结果 和 分组 都放到数组内 长度就是数组长度,此外数组内还有文本下标 不记在length内
<ul><li>所以在数组内只有 结果和 分组</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token string">`/url1/123/sg/12312`</span></span>
<span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token template-string"><span class="token string">`/url1/:id/:name/:l`</span></span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 获取id name 放到keys中</span>
<span class="token keyword">let</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">function</span> <span class="token function">pathToRegexp</span><span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> rs <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\:([^\/]+)/g</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`([^\/]+)`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> regexp <span class="token operator">=</span> <span class="token function">pathToRegexp</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> keys<span class="token punctuation">)</span>
<span class="token keyword">let</span> matchRs <span class="token operator">=</span> regexp<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> matchRs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> key <span class="token operator">=</span> keys<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
  data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> matchRs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> keys<span class="token punctuation">)</span>
</code></pre></div><h2 id="模板字符串"><a href="#模板字符串" aria-hidden="true" class="header-anchor">#</a> 模板字符串</h2> <ul><li>Function &amp;&amp; with</li> <li>new Function('参数',script), 参数可以写多个，script 是一个字符串,参数对应script里面的 参数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> s<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
  <span class="token keyword">let</span> script <span class="token operator">=</span> <span class="token template-string"><span class="token string">`
  console.log(obj,a)
  `</span></span>
  <span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'obj'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> script<span class="token punctuation">)</span>

  <span class="token function">fn</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'a1'</span> <span class="token punctuation">)</span>
  <span class="token comment">// 打印 {s:1} 'a1'</span>
</code></pre></div><ul><li>with</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">with</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>ejs</li> <li>单个渲染原理</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token template-string"><span class="token string">`hello &lt;%=name%&gt; world &lt;%=age%&gt;`</span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'zdpx'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">9</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;%=(\w+)%&gt;?/g</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">$<span class="token number">0</span><span class="token punctuation">,</span> $<span class="token number">1</span><span class="token punctuation">,</span> $<span class="token number">2</span><span class="token punctuation">,</span> $<span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> options<span class="token punctuation">[</span>$<span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>
</code></pre></div><ul><li>ejs if/for渲染原理</li> <li>主要用到2个语法
<ul><li>Function构造函数可以执行字符串脚本</li> <li>with(obj)语法 具有独立的作用域 里面的数据都可以从obj里面获取</li></ul></li> <li>render函数处理，
<ul><li>head 主要是申明变量和创建with 语法</li> <li>str 是处理的模板,将&lt;%xxx%&gt; 和&lt;%=xxx%&gt;这两种替换出来,注意顺序,先处理&lt;%=xxx%&gt;类型的,他主要是处理 具体值 ,&lt;%xxx%&gt;是将if或者for语法进行转换</li> <li>tpl变量要将 除if 和 for以外的所有数据里连接起来,所以会有<code>&quot;</code>;\n&quot; + arguments[1] + &quot;\n;tpl+=<code>&quot;</code>,tpl是我们最终要获取的值</li> <li>html 获取的是str用正则替换和 with语法包装后的结果</li> <li>最后通过Function函数将对象和html传进去 执行脚本</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> user<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'zdpx'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token template-string"><span class="token string">`
&lt;%if(user){%&gt;
  hello '&lt;%=user.name%&gt;'
&lt;%}else{%&gt;
  hi guest
&lt;%}%&gt;
&lt;ul&gt;
&lt;%for(let i=0;i&lt;total;i++){%&gt;
  &lt;li&gt;&lt;%=i%&gt;&lt;/li&gt;
&lt;%}%&gt;
&lt;/ul&gt;
`</span></span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> head <span class="token operator">=</span> <span class="token string">&quot;let tpl = ``;\n with(obj){ \n tpl+=` &quot;</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;%=([\s\S]+?)%&gt;/g</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;${&quot;</span> <span class="token operator">+</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;}&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;%([\s\S]+?)%&gt;/g</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;`;\n&quot;</span> <span class="token operator">+</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;\n;tpl+=`&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> tail <span class="token operator">=</span> <span class="token string">&quot;`} \n return tpl;&quot;</span> 
  <span class="token keyword">let</span> html <span class="token operator">=</span> head <span class="token operator">+</span> str <span class="token operator">+</span> tail<span class="token punctuation">;</span>
  <span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'obj'</span><span class="token punctuation">,</span> html<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> rs <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>

</code></pre></div><h2 id="观察者模式"><a href="#观察者模式" aria-hidden="true" class="header-anchor">#</a> 观察者模式</h2> <ul><li>被观察者(一个)  观察者(多个)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span><span class="token function">、被观察者提供维护观察者一系列方法</span> <span class="token punctuation">(</span>注入观察者 提供更新数据 获取数据方法<span class="token punctuation">)</span>
<span class="token number">2</span>、观察者提供更新接口
<span class="token number">3</span>、观察者把调用被观察者的注入方法自己注入到被观察者中
<span class="token number">4</span>、当被观察者中的数据变化 调用观察者中的更新方法

<span class="token keyword">class</span> <span class="token class-name">Fan</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> star</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>star <span class="token operator">=</span> star
        <span class="token keyword">this</span><span class="token punctuation">.</span>star<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'-----------'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>star<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Star</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>obervers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token punctuation">}</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> val
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notifyAllObervers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">attach</span><span class="token punctuation">(</span><span class="token parameter">oberver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>obervers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>oberver<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">notifyAllObervers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>obervers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">oberver</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            oberver<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> star <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Star</span><span class="token punctuation">(</span><span class="token string">'李明'</span><span class="token punctuation">,</span> <span class="token string">'blank'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> fan1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fan</span><span class="token punctuation">(</span><span class="token string">'fan1'</span><span class="token punctuation">,</span> star<span class="token punctuation">)</span>
<span class="token keyword">let</span> fan2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fan</span><span class="token punctuation">(</span><span class="token string">'fan2'</span><span class="token punctuation">,</span> star<span class="token punctuation">)</span>
star<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="发布订阅"><a href="#发布订阅" aria-hidden="true" class="header-anchor">#</a> 发布订阅</h2> <div class="language-js extra-class"><pre class="language-js"><code>订阅者 发布者 调度中心
订阅者把自己想订阅的事注册到调度中

<span class="token keyword">class</span> <span class="token class-name">Agent</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_event <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">publish</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">[</span>item<span class="token punctuation">]</span>
    <span class="token keyword">let</span> arg <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>

    listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">subsribe</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>listener</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">[</span>type<span class="token punctuation">]</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>listeners<span class="token punctuation">)</span><span class="token punctuation">{</span>
      listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_event<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>listener<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Tenant</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token punctuation">}</span>
  <span class="token function">rent</span><span class="token punctuation">(</span><span class="token parameter">agent</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    agent<span class="token punctuation">.</span><span class="token function">subsribe</span><span class="token punctuation">(</span><span class="token string">'house'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">area<span class="token punctuation">,</span>monry</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>area<span class="token punctuation">,</span>monry<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">LandLord</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span> name
  <span class="token punctuation">}</span>
  <span class="token function">lend</span><span class="token punctuation">(</span><span class="token parameter">agent<span class="token punctuation">,</span>area<span class="token punctuation">,</span>monry</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    agent<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'house'</span><span class="token punctuation">,</span>area<span class="token punctuation">,</span>monry<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> agent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Agent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> landLord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LandLord</span><span class="token punctuation">(</span><span class="token string">'房东'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> tenant1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tenant</span><span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> tenant2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tenant</span><span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">)</span>
tenant1<span class="token punctuation">.</span><span class="token function">rent</span><span class="token punctuation">(</span>agent<span class="token punctuation">)</span>
tenant2<span class="token punctuation">.</span><span class="token function">rent</span><span class="token punctuation">(</span>agent<span class="token punctuation">)</span>

landLord<span class="token punctuation">.</span><span class="token function">lend</span><span class="token punctuation">(</span>agent<span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="webpack-执行过程"><a href="#webpack-执行过程" aria-hidden="true" class="header-anchor">#</a> webpack 执行过程</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 配置 2、插件 3、run 4、make 5、seal 6、emitAssets</span>
<span class="token comment">// 1、执行npx webpack 他会找node_modules .bin/webpack.cmd =&gt; webpack/bin/webpack.js =&gt; webpack-cli/bin/cli 入口文件就这 获取webpack配置 webpack(options) 得到compiler实例 通过compiler.run 开始编译</span>

<span class="token comment">// 2、解析配置 解析shell 和webpack 配置选项 </span>

<span class="token comment">// 3、初始化 注册nodeEnvironmentPlugin插件，执行所有webpack 配置插件, 使用webpackOptionApply初始化基础插件</span>

<span class="token comment">// 4、run `compiler.run` 会执行内部的`this.compile`他是真正开始编译  他内部会初始化`Compilation`,`Compilation`负责了整个编译过程,内部的`this.compiler`执行conpiler对象，创建entries入口、chunks代码块、modules所有模型、assets所有的资源、模板(mainTemplate,chunkTemplate,hotUpdateChunkTempalte,moduelTemplate,runtimeTemplate)</span>

<span class="token comment">// 5、make 事件触发 singleEntryPlugin 插件 执行compilation.addEntry,根据入口文件通过工厂方式创建代码块模块保存到`entries`内,触发module.build方法对源码进行loader处理 在进行ast语法解析，会将`require`替换成`__webpack_require__`,同时遇到`require`会创建 dependency 添加到依赖数组。module处理完成后 处理依赖模块</span>

<span class="token comment">// 6、seal 对每个每个chunk 和 module进行处理,创建代码块资源，通过模板把chunk生成__webpack_require__()的格式  mainTemplate处理入口的module chunkTemplate处理异步加载 生成资源放在compilation.assets中</span>

<span class="token comment">// 7、emitAssets 把assets输出到output的path中</span>
</code></pre></div><h2 id="主要的生命周期-插件"><a href="#主要的生命周期-插件" aria-hidden="true" class="header-anchor">#</a> 主要的生命周期 插件</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 入口 webpackOptionApply entryOption</span>
<span class="token comment">// run beforeRun beforeCompile compile thisCompilation compilation</span>
<span class="token comment">// make buildModule successModule finishModules</span>
<span class="token comment">// seal seal optimize reviveModule reviveChunk beforeChunk beforeHash afterHash afterChunk beforeModuleAssets chunkAssets</span>
<span class="token comment">// emit emit afterEmit done afterSeal </span>
</code></pre></div><h2 id="jsonp"><a href="#jsonp" aria-hidden="true" class="header-anchor">#</a> jsonp</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// function jsonp({url,params,cb}){</span>
<span class="token comment">//     return new Promise((resolve,reject)=&gt;{</span>
<span class="token comment">//         window[cb] = function(data){</span>
<span class="token comment">//             resolve(data)</span>
<span class="token comment">//         }</span>
<span class="token comment">//         params = {...params,cb}</span>
<span class="token comment">//         let arr = []</span>
<span class="token comment">//         for(let i in params){</span>
<span class="token comment">//             arr.push(`${i}=${params[i]}`)</span>
<span class="token comment">//         }</span>
<span class="token comment">//         params = arr.join('&amp;')</span>
<span class="token comment">//         let dom = document.createElement('script')</span>
<span class="token comment">//         dom.src = `${url}?${params}`</span>
<span class="token comment">//         document.body.appendChild(dom)</span>
<span class="token comment">//     })</span>
<span class="token comment">// }</span>
<span class="token comment">// jsonp({</span>
<span class="token comment">//     url:'http://localhost:4000/123',</span>
<span class="token comment">//     params:{age:1},</span>
<span class="token comment">//     cb:'cb'</span>
<span class="token comment">// }).then(data=&gt;{</span>
<span class="token comment">//     console.log(data)</span>
<span class="token comment">// })</span>

<span class="token comment">// let express = require('express')</span>
<span class="token comment">// let app= express()</span>
<span class="token comment">// app.get('/123',(req,res)=&gt;{</span>
<span class="token comment">//     let {cb} = req.query</span>
<span class="token comment">//     console.log(cb)</span>
<span class="token comment">//     res.end(`(${cb})('123')`)</span>
<span class="token comment">// })</span>
<span class="token comment">// app.listen('4000',function(){</span>
<span class="token comment">//     console.log('start')</span>
<span class="token comment">// })</span>
</code></pre></div><h2 id="ajax"><a href="#ajax" aria-hidden="true" class="header-anchor">#</a> ajax</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// let xhr = new XMLHttpRequest()</span>
<span class="token comment">// xhr.open('get','http://localhost:4000/123',true)</span>
<span class="token comment">// xhr.onreadystatechange = function(){</span>
<span class="token comment">//     if(xhr.readyState == 4&amp;&amp;xhr.status==200){</span>
<span class="token comment">//         console.log(xhr.responseText)</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
<span class="token comment">// xhr.send()</span>
</code></pre></div><h2 id="懒加载"><a href="#懒加载" aria-hidden="true" class="header-anchor">#</a> 懒加载</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 分2步骤 分割代码,jsonp加载数据</span>
<span class="token comment">// 分割代码，在ast解析的时候  遇到Import('xx')语法 会把他解析成__webpack_require__.e('chunkId').then(__webpack_require__.t.bind(module,dependencyChunkId,7)).then(data=&gt;data.default)</span>
<span class="token comment">// 其中 dependencyChunkId 对应分隔文件的 对象的key值</span>
<span class="token comment">// jsonp 加载数据 </span>
<span class="token comment">// __webpack_require__.e 方法就是实现了jsonp加载数据,创建script标签 加载数据分隔数据的js文件 获取数据,他对象数据添加到modules对象上,通过__webpack_require__.t 去解析数据到页面中</span>
</code></pre></div><h2 id="hot-更新"><a href="#hot-更新" aria-hidden="true" class="header-anchor">#</a> hot 更新</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// server 端</span>
<span class="token comment">// 创建一个sever&amp;&amp;io,io用来监控客户端连接,将连接的所有client存放起来,同时监控hooks.done钩子,每次编译完成的时候,循环所有的client 并且告诉他们 当前的编译的hash值和一个ok,内部要修改把compiler的输出文件系统改成了 MemoryFileSystem(内存)</span>
<span class="token comment">// client 端</span>
<span class="token comment">// module.hot.accept('moduleId',fn) 缓存数据</span>
<span class="token comment">// 创建一个发布订阅 client 监控到 server发送过来的hash保存,当socket接收到ok事件事件,会发送`webpackHotUpdate`事件,第一次的时候 会保存当前的hash值,第二次的时候才会走hot的逻辑 </span>
<span class="token comment">//  1、更新的时候 会用 hash(上一次保存的hash)+'.hot-update.json'发送get请求,询问服务器到底这一次编译相对上一次编译改变了哪些chunk,哪些模块,返回的 h是当前的hot hash值 c是当前变化的chunkId(c是一个对象,key是 chunkId,value是true)</span>
<span class="token comment">//  2、遍历c对象,jsonp请求变化的数据,url是 chunkId+用更新前的上一次hash(hotCurrentHash)+'.hot.update.js',返回的是 webpackHotUpdate('chunkId',{moduleId:value})</span>
<span class="token comment">//  3、webpackHotUpdate 作用 遍历jsonp过来的的数据 1、通过__webpack_require__ 加载有变化的module 2、通过moduleId 获取到parentModule 在里面取到hot里之前缓存的函数执行，加载最新的数据 </span>
</code></pre></div><h2 id="loader"><a href="#loader" aria-hidden="true" class="header-anchor">#</a> loader</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1、给 loaderContext 上下文定义4个变量,request当前所有的loader,remindingRequest剩下的loader,previousRequest之前的loader,data用来共享数据</span>
<span class="token comment">// 2、异步处理 isSync 默认是true 当执行async 的时候 会改变 isSync会变成false, 异步执行返回函数的时候 会将isSync变成true</span>
<span class="token comment">// 3、先处理 iteratePitchingLoaders 当其中一个pitch函数没有返回值的时候 直接执行下一个 若有返回值的时候 执行他并且传入 remindingRequest,previousRequest,data 为参数</span>
<span class="token comment">// 4、pitch执行完成后处理 normal.raw 当为true的时候 就变成二进制,否则不处理</span>
<span class="token comment">// 5、处理 iterateNormalLoaders 一次执行 当执行完最后一个就 退出去 执行回调函数</span>
</code></pre></div><h2 id="express"><a href="#express" aria-hidden="true" class="header-anchor">#</a> express</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 基本流程 get等 use listen  </span>
<span class="token comment">// 1、首先是路由 每一层router 都用Layer创建，第一个参数是路径,第二个参数是处理函数 router.dispatch(每个router 存放着当前路由的所有处理) 将他们存放起来</span>
<span class="token comment">// 2、每一层的router 每一次实例的router(layer.router)存放自己  用来去获取当前一层的处理函数和是否是use(use 这一层的router是undefined) 遍历所有的请求methods 只要是某一个请求方式 第一个是路径参数  后面的都是处理函数   获取他所有的处理函数 遍历每一个  都创建一个layer实例 第一个参数是 路径  第二个参数是遍历的单个函数 然后push到当前的stack中。当前类有一个dispatch方法 就是遍历执行所有的 stack 保存的函数</span>
<span class="token comment">// 3、listen 在执行  创建 Http.createServer的时候  开始遍历(handle) 执行第一个router 里的所有stack存储的函数,执行完成后 调用next 在取第二个router 就这样依次执行</span>
<span class="token comment">// 4、use 和 路由 其实差不多 区别就是 每一层实例的router保存的值不一样 做区别,use是undefined 路由则是每一层的处理函数 use和路由一样 同样是用 Layer创建的 当没有二级中间件的时候 path(路径)就是/,有二级中间件的时候 path就是第一个参数,创建好之后 同样放入到当前实例的stack中,在遍历的时候 就通过layer.router下面是否有值判断是中间件还是路由</span>
</code></pre></div><h3 id="子路由系統"><a href="#子路由系統" aria-hidden="true" class="header-anchor">#</a> 子路由系統</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// express.Router() 内部会返回一个router实例 他和express()返回的是一样的 前者是通过函数返回  后者是通过 原型链 构造，Object.setPrototypeOf(fn,{})主要是通过这个api,将对象挂载到函数的原型链上</span>
<span class="token comment">// 返回的实例 同时具备use get等方法 二级路由 就是通过app.use('/xxx',子路由实例)</span>
<span class="token comment">/**
 * A 函数new 和 直接执行 原型链都一样
 * function A(){
 *  function b(){
 *  }
 *  Object.setPrototypeOf(b,proto)
 *  return b 
 * }
 * let proto = Object.create(null)
 * proto.a= ()=&gt;{}
*/</span>
</code></pre></div><h3 id="路径参数处理"><a href="#路径参数处理" aria-hidden="true" class="header-anchor">#</a> 路径参数处理</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1、他会通过下面的库 在匹配路径的时候 他会提取:后面的key值 在匹配传递过来的路径 进行一一对应 挂载到params对象上</span>
<span class="token comment">// 2、匹配到路径 处理函数的时候  会拦截处理 遍历是否有 路径参数 对应的函数 会一个一个的遍历执行 同时他也是通过 中间件的形式一个个执行 这个时候 我们可以在req对象上挂载东西</span>
</code></pre></div><h3 id="path-to-regexp"><a href="#path-to-regexp" aria-hidden="true" class="header-anchor">#</a> path-to-RegExp</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
  path-to-regexp 这个库是通过路径 来提取正则
  let pathToRegexp = require('path-to-regexp')
  let path = '/user/:uid/:name';
  let keys = []

  function pathToRegexp(path, keys) {
    return path.replace(/\:([^\/]+)/g, ($1, $2, $3) =&gt; {
      console.log('===&gt;',$1,$2,$3)
      keys.push({
        name: $2,
        optional:$3,// 偏移量
        replace: false
      })
      return '([^\/]+)'
    })
  }

  let rs = pathToRegexp(path, keys)
  let str = '/user/123/wew'
  let a = rs.exec(str)
  console.log(keys,a)
*/</span>
</code></pre></div><h3 id="模板引擎"><a href="#模板引擎" aria-hidden="true" class="header-anchor">#</a> 模板引擎</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app.set('view engine',path.resolve(__dirname, 'views')) 用来设置 模板文件的位子</span>
<span class="token comment">// app.set('view engine', 'html') 这个是用来设置模板文件的后缀格式</span>
<span class="token comment">// app.engine('html', ejs) 这个 设置html 结尾的 就用ejs 模板进行渲染 ejs是一个函数</span>
</code></pre></div><h3 id="中间件"><a href="#中间件" aria-hidden="true" class="header-anchor">#</a> 中间件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 中间件 格式 use 传入一个函数 参数分别是req,res,next</span>
<span class="token comment">/*
  app.use(function(req, res, next) {
    let { pathname } = url.parse(req.url)
    req.path = pathname
    next()
  })
*/</span>
<span class="token comment">// static中间件 静态目录</span>
<span class="token comment">/*
function static(){
  function(req, res, next) {
    let staticPath = path.join(p, req.url)
    let exists = fs.existsSync(staticPath)
    if (exists) {
      let html = fs.readFile(staticPath, (err, item) =&gt; {
        res.setHeader('Content-Type', 'text/html')
        // res.setHeader('Content-type', 'image/gif')
        res.end(item)
      })
    } else {
      next()
    }
  }
}
*/</span>

<span class="token comment">// bodyParser 请求的参数解析</span>
<span class="token comment">/*
function bodyParser() {
  return function(req, res, next) {
    let rs = []
    req.on('data', function(data) {
      rs += data
    })
    req.on('end', function(data) {
      try {
        req.body = JSON.parse(rs)
      } catch (e) {
        req.body = require('querystring').parse(rs)
      }
      next()
    })
  }
};
*/</span>
</code></pre></div><h3 id="ejs"><a href="#ejs" aria-hidden="true" class="header-anchor">#</a> ejs</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ejs 单个渲染原理</span>
<span class="token comment">// let str = `hello &lt;%=name%&gt; world &lt;%=age%&gt;`;</span>
<span class="token comment">// let options = { name: 'zdpx', age: 9 }</span>

<span class="token comment">// function render(str, options) {</span>
<span class="token comment">//   return str.replace(/&lt;%=(\w+)%&gt;?/g, ($0, $1, $2, $3) =&gt; {</span>
<span class="token comment">//     return options[$1]</span>
<span class="token comment">//   })</span>
<span class="token comment">// }</span>

<span class="token comment">// let rs = render(str, options)</span>
<span class="token comment">// console.log(rs)</span>

<span class="token comment">// ejs if渲染原理</span>
<span class="token comment">// let options = { user: { name: 'zdpx', age: 9 }, total: 5 }</span>
<span class="token comment">// let str = `</span>
<span class="token comment">// &lt;%if(user){%&gt;</span>
<span class="token comment">//   hello '&lt;%=user.name%&gt;'</span>
<span class="token comment">// &lt;%}else{%&gt;</span>
<span class="token comment">//   hi guest</span>
<span class="token comment">// &lt;%}%&gt;</span>
<span class="token comment">// &lt;ul&gt;</span>
<span class="token comment">// &lt;%for(let i=0;i&lt;total;i++){%&gt;</span>
<span class="token comment">//   &lt;li&gt;&lt;%=i%&gt;&lt;/li&gt;</span>
<span class="token comment">// &lt;%}%&gt;</span>
<span class="token comment">// &lt;/ul&gt;</span>
<span class="token comment">// `</span>

<span class="token comment">// function render(str, options) {</span>
<span class="token comment">//   let head = &quot;let tpl = ``;\n with(obj){ \n tpl+=` &quot;</span>
<span class="token comment">//   str = str.replace(/&lt;%=([\s\S]+?)%&gt;/g, function() {</span>
<span class="token comment">//     return &quot;${&quot; + arguments[1] + &quot;}&quot;</span>
<span class="token comment">//   })</span>
<span class="token comment">//   str = str.replace(/&lt;%([\s\S]+?)%&gt;/g, function() {</span>
<span class="token comment">//     return &quot;`;\n&quot; + arguments[1] + &quot;\n;tpl+=`&quot;;</span>
<span class="token comment">//   })</span>
<span class="token comment">//   let tail = &quot;`} \n return tpl;&quot;</span>
<span class="token comment">//   let html = head + str + tail;</span>
<span class="token comment">//   console.log('html=&gt;', html)</span>
<span class="token comment">//   let fn = new Function('obj', html)</span>
<span class="token comment">//   return fn(options)</span>
<span class="token comment">// }</span>

<span class="token comment">// let rs = render(str, options)</span>
<span class="token comment">// console.log(rs)</span>
</code></pre></div><h2 id="react-0-3版本的"><a href="#react-0-3版本的" aria-hidden="true" class="header-anchor">#</a> React(0.3版本的)</h2> <h3 id="react-渲染流程"><a href="#react-渲染流程" aria-hidden="true" class="header-anchor">#</a> React 渲染流程</h3> <ul><li>1、jsx语法会通过babel转成虚拟DOM</li> <li>2、虚拟DOM在创建元素的时候,会分成原生DOM,文本节点,函数组件3类,在分别创建对应的节点，文本标签会用span标签包裹返回。原生dom,他会解析里面的属性,通过事件委托的方式绑定dom事件,赋值标签属性,递归渲染儿子节点。函数组件,类组件会转成函数组件,类组件的生命期在这处理,return或者render 返回的内容，通过递归创建dom</li> <li>3、 setState 方法是 React.Component 类提供的方法,他内部会去调用 当前组件的.update方法将新状态传递进去,然后进行状态合并。比较元素的谭类型是否相同,不相同就直接砍掉重新创建元素,相同先比较属性,在比较children(diff)</li></ul> <h3 id="diff-比较"><a href="#diff-比较" aria-hidden="true" class="header-anchor">#</a> diff 比较</h3> <ul><li>1、如果说新老一致的话 说明复用了老节点,如果老元素的位子小于(已遍历老元素的位子)就要往后移动(添加补丁包)</li> <li>2、当标签不一样的时候 key 相同,老节点没有复用的 要删除原有的 (添加补丁包)</li> <li>3、新的节点 就去创建(添加补丁包)</li> <li>4、新节点里面没有老节点的 要删除掉(添加补丁包)</li> <li>5、等待所有元素比较完成,开始打补丁包,补丁包先做删除dom操作,在做移动和添加操作</li></ul> <h3 id="redux"><a href="#redux" aria-hidden="true" class="header-anchor">#</a> redux</h3> <h2 id="vue"><a href="#vue" aria-hidden="true" class="header-anchor">#</a> vue</h2> <h3 id="domdiff"><a href="#domdiff" aria-hidden="true" class="header-anchor">#</a> DOMDiff</h3> <ul><li>核心的patch方法,接收(新节点,老节点)</li> <li>1、比较标签,当标签不一样,直接替换</li> <li>2、标签一样,比较文本,如果内容不一样,用新的替换老的文本节点</li> <li>3、标签一样,比较属性,遍历新老属性,进行修改</li> <li>4、比较儿子节点,a、当老的有孩子,新的没有孩子,直接删除老的child。b、当老的没有孩子,新的有孩子,递归遍历新的孩子往老节点添加。c、当都有孩子的时候是最烦,分5中策略
<ul><li>开头插入,从头开始比较(新 a b c d,老 a b c d e的情况下) 先比较新老的第一个始比较,下次比较第二个</li> <li>结尾插入,从尾巴开始比较(新 a b c d,老 e a b c d的情况下) 先比较新老的最后一个,下次在比较倒数第二个</li> <li>正序,用新的头和老的尾巴开始比较,(新的 a b c d,老的 d c b a)</li> <li>倒序,用新的尾巴和老的头开始比较,(新的 a b c d,老的 d a b c )</li> <li>乱序,顺序不确定的情况,遍历新节点,用新的第一个DOM去老的里面匹配,如不匹配则直接插入到老节点的前面,如匹配则直接一定老节点。新节点遍历完成,在看老节点中还有剩余的(新节点中没有的)直接删除</li> <li>最后比较完,判断新节点中还有剩余的元素则需要将剩余的插入，如果老节点中还有剩余则需要全部删除</li></ul></li> <li>注意 循环的是 尽量不要使用索引作为key 可能会导致重新创建当前元素的所有子元素</li></ul> <h3 id="完整的导航解析流程"><a href="#完整的导航解析流程" aria-hidden="true" class="header-anchor">#</a> 完整的导航解析流程</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
  导航被触发。
  在失活的组件里调用离开守卫。(组件内 beforeRouteLeave)
  调用全局的 beforeEach 守卫。(全局前置守卫 beforeEach )
  在重用的组件里调用 beforeRouteUpdate 守卫 (组件内的 beforeRouteUpdate, /foo/1 和 /foo/2 之间跳转的时候用到)
  在路由配置里调用 beforeEnter。(组件内 beforeEnter)
  解析异步路由组件。(全局router.beforeResolve  在导航被确认之前,所有组件内守卫和异步路由组件被解析之后)
  在被激活的组件里调用 beforeRouteEnter(在组件渲染前 不能获取this)
  调用全局的 beforeResolve 守卫 
  导航被确认。
  调用全局的 afterEach 钩子。
  触发 DOM 更新。
  用创建好的实例调用 beforeRouteEnter 守卫中传给 next 的回调函数。


  路由配置守卫即配置在路由对象中

    组件实力的导航守卫： beforeRouteLeave beforeRouteEnter beforeRouteUpdate

    全局守卫： beforeEach beforeResolve afterEach

    路由配置守卫： beforeEnter

*/</span>
</code></pre></div><h3 id="vuex"><a href="#vuex" aria-hidden="true" class="header-anchor">#</a> vuex</h3> <ul><li>vue是单向数据流，组件变动不能驱动数据，而是数据变动驱动组件</li> <li>同步情况 调用mutation改数据</li> <li>异步情况，派发action，调用api，再在action里调用mutation改数据</li> <li>vuex 数据持久化vuex-persits</li></ul> <h3 id="vuex原理"><a href="#vuex原理" aria-hidden="true" class="header-anchor">#</a> vuex原理</h3> <ul><li>每个vue插件 内部都提供install方法,他接收Vue</li> <li>install 方法内部通过 vue.mixin 把store属性传递给每个组件</li></ul> <h2 id="vue-router"><a href="#vue-router" aria-hidden="true" class="header-anchor">#</a> vue-router</h2> <ul><li>hash 通过hashchange监控hash变化</li> <li>history api 通过pushState</li></ul> <h2 id="fiber"><a href="#fiber" aria-hidden="true" class="header-anchor">#</a> fiber</h2> <h2 id="微前端"><a href="#微前端" aria-hidden="true" class="header-anchor">#</a> 微前端</h2> <ul><li>名词解析:微前端就是后端微服务在前段的映射</li> <li>如何在浏览器落地
<ul><li>1、iframe</li> <li>2、single-spa</li></ul></li> <li>场景
<ul><li>1、将大的复杂的应用 拆分成多个小的app进行加载</li> <li>2、将不同的app 组合到一起 进行加载(vue，react项目)</li></ul></li> <li>每个app 向外export4个生命周期()
<ul><li>1、bootstrap(启动,每个app只会启动一次)</li> <li>2、mount(挂载)</li> <li>3、ummount(卸载)</li> <li>4、update(更新)</li></ul></li> <li>卸载
<ul><li>vue vueInstance.$destory()</li> <li>react
<ul><li>ReactDOM.ummountComponentAtNode(element)</li> <li>ReactDOM.findNode(reactInstance)</li></ul></li></ul></li></ul> <h3 id="执行流程-核心"><a href="#执行流程-核心" aria-hidden="true" class="header-anchor">#</a> 执行流程(核心)</h3> <ul><li>触发的时机
<ul><li>1、浏览器触发,拦截onhashchange和onpopstate事件</li> <li>2、手动触发,注册app和start启动这两个方法</li></ul></li> <li>修改队列(changesQueue)
<ul><li>每次触发时机进行一次触发操作,都会被存放到changesQueue队列中,类似事件队列一样,等待被处理,不过changesQueue是成批执行。而js事件循环是一个个执行</li></ul></li> <li>事件循环
<ul><li>每一次事件开始循环,会判断为前端框架是否已经启动</li> <li>1、如果没有,则loadApps,加载完成后调用内部的finish</li> <li>2、若启动了,则执行完成的app的生命周期,unMount App load App Mount App,</li> <li>不管是否启动,都会执行finish,finish就是判断当前队列是否为空,如果不为空就重新循环一次,为空的话中止循环退出流程</li></ul></li> <li>location事件
<ul><li>每次循环中止都会将已拦截的location事件进行触发,这样保证为前端的location触发事件总是最先的,vue和React总是在后面</li></ul></li></ul> <h2 id="性能监控"><a href="#性能监控" aria-hidden="true" class="header-anchor">#</a> 性能监控</h2> <ul><li>监控全局捕获错误,普通的监听<code>error</code>,异步的监听<code>unhandledrejection</code></li> <li>ajax 进行接口监控,在请求成功或失败的时候进行日志上报</li> <li>监控白屏,白屏原理:在onload时 在页面中通过<code>document.elementsFromPoint(x,y)</code>进行取点和已有的包裹元素进行
<ul><li><code>elementsFromPoint</code>方法可以获取到当前视口内指定坐标处，由里到外排列的所有元素</li></ul></li> <li>性能指标,通过<code>performance Timing</code>对页面每个时间段进行分析</li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">10/25/2020, 6:55:16 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/interview/leetcode.html" class="prev">
          leetcode
        </a></span> <span class="next"><a href="/interview/cssBase.html">
          css
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.2d5a21ba.js" defer></script><script src="/assets/js/62.3f032d2a.js" defer></script>
  </body>
</html>
